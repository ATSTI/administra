CREATE OR ALTER TRIGGER ALTERA_VALOR_PRAZO FOR PRODUTOS
ACTIVE AFTER UPDATE POSITION 0
AS 
declare variable VALORPRAZO double precision;
BEGIN 
	if (new.VALORUNITARIOATUAL <> old.VALORUNITARIOATUAL) then
	  if(not new.TIPOPRECOVENDA <> 'U')then
      begin  
        VALORPRAZO = ((new.VALORUNITARIOATUAL * new.MARGEM) /100) + new.VALORUNITARIOATUAL;
        update PRODUTOS set VALOR_PRAZO = :VALORPRAZO where CODPRODUTO = new.CODPRODUTO;
      end
END
