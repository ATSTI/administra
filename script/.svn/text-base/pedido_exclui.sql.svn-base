SET TERM ^ ;
CREATE OR ALTER TRIGGER PEDIDO_EXCLUI FOR MOVIMENTODETALHE ACTIVE 
AFTER DELETE POSITION 0
AS 
  DECLARE VARIABLE NAT SMALLINT;
  DECLARE VARIABLE codUsuario SMALLINT;
  DECLARE VARIABLE codVendedor SMALLINT;
  DECLARE VARIABLE codMov INT;
  DECLARE VARIABLE codProduto INT;  
  DECLARE VARIABLE codFornece INT;  
  DECLARE VARIABLE codCotacao INT; 
  DECLARE VARIABLE prazo VARCHAR(30); 
  DECLARE VARIABLE obs VARCHAR(100); 
  DECLARE VARIABLE entrega date; 
  DECLARE VARIABLE frete DOUBLE PRECISION; 
  DECLARE VARIABLE descProd  VARCHAR(300); 
  DECLARE VARIABLE qtde DOUBLE PRECISION; 
  DECLARE VARIABLE preco DOUBLE PRECISION; 
BEGIN 
  -- Se Pedido foi gerado por Recebimento de Materiais, retorna o recebimento para 0 (Zero)
  Select m.CODMOVIMENTO from MOVIMENTO m 
   where m.CODFORNECEDOR = :codFornece
     and m.CONTROLE      = :codCotacao
     and m.CODNATUREZA   = 5